<div class="date-plan-picker slide-in--up-slow">
  <div class="space-info fade-in--slow">
    <h1>{{ space.name }}</h1>
    <div class="meta">
      <span class="type">{{ space.type | titlecase }}</span>
      <span *ngIf="space.capacity">• Capacity: {{ space.capacity }}</span>
    </div>
  </div>

  <div class="plan-section">
    <label class="plan-label">Choose Plan:</label>
    <mat-radio-group
      [(ngModel)]="plan"
      (change)="onPlanChange()"
      aria-label="Select booking plan"
    >
      <mat-radio-button value="Hourly">Hourly</mat-radio-button>
      <!-- <mat-radio-button value="Half-day">Half Day</mat-radio-button> -->
      <mat-radio-button value="Daily">Daily</mat-radio-button>
      <!-- <mat-radio-button value="Monthly">Monthly</mat-radio-button> -->
    </mat-radio-group>
  </div>

  <!-- Quantity Selection -->
  <!-- <div class="quantity-section slide-in--left-slow" *ngIf="space.capacity && space.capacity > 1">
    <label>Select Quantity:</label>
    <mat-form-field appearance="fill">
      <mat-label>Number of {{ space.type === 'desk' ? 'desks' : 'rooms' }}</mat-label>
      <input 
        matInput 
        type="number" 
        [(ngModel)]="quantity" 
        min="1" 
        [max]="space.capacity" 
        (change)="onQuantityChange()"
        aria-label="Select quantity"
      >
      <mat-hint *ngIf="space.capacity">Available: {{ space.capacity }}</mat-hint>
    </mat-form-field>
  </div> -->

  <div class="date-grid-section">
    <div class="month-nav">
      <button class="btn" (click)="prevDays()">&#8592; Prev 7 Days</button>
      <span class="month-label">{{ year }} - {{ month + 1 | number:'2.0' }}</span>
      <button class="btn" (click)="nextDays()">Next 7 Days &#8594;</button>
    </div>
    <label>Select Date & Hour:</label>
    <div class="date-hour-grid">
      <div class="grid-header">
        <div class="grid-cell header-cell">Day</div>
        <div class="grid-cell header-cell" *ngFor="let hour of hoursGrid">{{ hour }}:00</div>
      </div>
      <div class="grid-row" *ngFor="let row of slotGrid">
        <div class="grid-cell day-cell">{{ row.date | date:'d MMM' }}</div>
        <div
          class="grid-cell slot-cell"
          *ngFor="let slot of row.slots"
          [ngClass]="{
            available: slot.available,
            unavailable: !slot.available,
            selected: date && row.date.getTime() === date.getTime() && startTime === slot.hour
          }"
          (click)="slot.available ? selectSlot(row.date, slot.hour) : null"
        >
          <span>{{ slot.available ? '✔' : '✖' }}</span>
        </div>
      </div>
    </div>
  </div>
  <div class="error" *ngIf="error" role="alert">{{ error }}</div>

  <div class="price-summary" *ngIf="price > 0 && !error">
    <span
      >Total Price: <strong>{{ price | number : "1.0-2" }} EGP</strong></span
    >
    <span *ngIf="price > 0 && !error" class="price-breakdown">
      ( {{ bookedHours }} hours × {{ getPackagePrice() }} EGP)
      <br />
      Package : {{ pricingPackage }}
    </span>
    <span> </span>
  </div>

  <div class="actions">
    <button class="btn-secondary btn" (click)="back()" aria-label="Go back">
      Back
    </button>
    <button
      class="btn-primary btn"
      (click)="next()"
      [disabled]="
        !date || (isDaily && !endDate) || (isHourly && (!startTime || !endTime))
      "
      aria-label="Proceed to next step"
    >
      Next
    </button>
  </div>
</div>
